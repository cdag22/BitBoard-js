var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var BitBoard=function(){function BitBoard(board){var _this=this;this.MAX_BITS=4294967296;this.BITS_PER_BUCKET=32;this.length=64;this.board;if(board){if(typeof board==="string"){if(board.split("").some(function(n){return n!=="0"&&n!=="1"})||board.length>this.length){throw new SyntaxError("Inputs to board as a string must be between 1 and 64 zeroes and ones")}var left=board.length>32?parseInt(board.slice(0,board.length-32),2):0;var right=board.length>32?parseInt(board.slice(32),2):parseInt(board,2);this.board=[left,right]}else if(Array.isArray(board)){if(board.some(function(x){return typeof x!=="number"})||board.length!==2||board.some(function(x){return Math.floor(x)!==x||x<0||x>=_this.MAX_BITS})){throw new Error("array inputs to board must be two integers x where  0 <= x < 2 ^ 32 (or 4294967296)")}this.board=board}}else{this.board=[0,0]}}BitBoard.prototype.determineIfBitBoard=function(bb){var _this=this;var names=Object.getOwnPropertyNames(bb);var doPrototypesMatch=Object.getPrototypeOf(bb)===BitBoard.prototype;var arePropertyNamesCorrect=names.every(function(name){return["board","length","BITS_PER_BUCKET","MAX_BITS"].indexOf(name)!==-1});var isBoardLengthCorrect=bb.board&&bb.board.length===2&&bb.length===this.length;var isBoardArrayCorrect=Array.isArray(bb.board)&&bb.board.every(function(n){return typeof n==="number"&&n>=0&&n<_this.MAX_BITS&&Math.floor(n)===n});return arePropertyNamesCorrect&&isBoardLengthCorrect&&isBoardArrayCorrect&&doPrototypesMatch};BitBoard.prototype.toString=function(){var str="";for(var i=0;i<this.board.length;i++){str+=padString((this.board[i]>>>0).toString(2),this.BITS_PER_BUCKET,"0",true)}return str};BitBoard.prototype.getIndex=function(index){if(Math.floor(index)===index&&index>=0&&index<this.length){var powOfTwo=Math.pow(2,index%this.BITS_PER_BUCKET);var bucketOffset=index>this.BITS_PER_BUCKET?1:0;return(this.board[1-bucketOffset]&powOfTwo)>>>0>0?1:0}throw new RangeError("index must be integer greater than or equal to 0 and less than 64")};BitBoard.prototype.copy=function(){return new BitBoard(this.board.slice())};BitBoard.prototype.isEmpty=function(){return this.board[0]===0&&this.board[1]===0};BitBoard.prototype.and=function(bb,modify){if(modify===void 0){modify=false}if(this.determineIfBitBoard(bb)){var targetBoard=modify?this:this.copy();for(var i=0;i<this.board.length;i++){targetBoard.board[i]=(targetBoard.board[i]&bb.board[i])>>>0}return targetBoard}throw new TypeError("Invalid input. Must be of type BitBoard")};BitBoard.prototype.or=function(bb,modify){if(modify===void 0){modify=false}if(this.determineIfBitBoard(bb)){var targetBoard=modify?this:this.copy();for(var i=0;i<this.board.length;i++){targetBoard.board[i]=(targetBoard.board[i]|bb.board[i])>>>0}return targetBoard}throw new TypeError("Invalid input. Must be of type BitBoard")};BitBoard.prototype.xOr=function(bb,modify){if(modify===void 0){modify=false}if(this.determineIfBitBoard(bb)){var targetBoard=modify?this:this.copy();for(var i=0;i<this.board.length;i++){targetBoard.board[i]=(targetBoard.board[i]^bb.board[i])>>>0}return targetBoard}throw new TypeError("Invalid input. Must be of type BitBoard")};BitBoard.prototype.orNumber=function(shiftAmount,num,modify){if(shiftAmount===void 0){shiftAmount=0}if(num===void 0){num=1}if(modify===void 0){modify=false}if(typeof shiftAmount==="number"&&typeof num==="number"){if(shiftAmount>=0&&shiftAmount<this.length&&num>=0&&num<this.MAX_BITS){var targetBoard=modify?this:this.copy();var startDigits=(num<<shiftAmount>>>0&Math.pow(2,32)-1)>>>0;var startDigitMask=(startDigits&Math.pow(2,32)-1)>>>0;var numCarryDigits=num>>>32-shiftAmount>>>0;if(shiftAmount===32){targetBoard.board[0]=(targetBoard.board[0]|num)>>>0}else if(shiftAmount===0){targetBoard.board[1]=(targetBoard.board[1]|startDigitMask)>>>0}else if(shiftAmount>32&&shiftAmount<64){targetBoard.board[0]=(targetBoard.board[0]|startDigitMask)>>>0}else{targetBoard.board[1]=(targetBoard.board[1]|startDigitMask)>>>0;targetBoard.board[0]=(targetBoard.board[0]|numCarryDigits)>>>0}return targetBoard}throw new RangeError("0 <= shiftAmount < 64 && 0 <= num <= 2 ^ 32 - 1")}throw new TypeError("Invalid input. Must be of type number")};BitBoard.prototype.xOrNumber=function(shiftAmount,num,modify){if(shiftAmount===void 0){shiftAmount=0}if(num===void 0){num=1}if(modify===void 0){modify=false}if(typeof shiftAmount==="number"&&typeof num==="number"){if(shiftAmount>=0&&shiftAmount<this.length&&num>=0&&num<this.MAX_BITS){var targetBoard=modify?this:this.copy();var startDigits=(num<<shiftAmount>>>0&Math.pow(2,32)-1)>>>0;var startDigitMask=(startDigits&Math.pow(2,32)-1)>>>0;var numCarryDigits=num>>>32-shiftAmount>>>0;if(shiftAmount===32){targetBoard.board[0]=(targetBoard.board[0]^num)>>>0}else if(shiftAmount===0){targetBoard.board[1]=(targetBoard.board[1]^startDigitMask)>>>0}else if(shiftAmount>32){targetBoard.board[0]=(targetBoard.board[0]^startDigitMask)>>>0}else{targetBoard.board[1]=(targetBoard.board[1]^startDigitMask)>>>0;targetBoard.board[0]=(targetBoard.board[0]^numCarryDigits)>>>0}return targetBoard}throw new RangeError("0 <= shiftAmount < 64 && 0 <= num <= 2 ^ 32 - 1")}throw new TypeError("Invalid input. Must be of type number")};BitBoard.prototype.not=function(modify){if(modify===void 0){modify=false}var targetBoard=modify?this:this.copy();for(var i=0;i<targetBoard.board.length;i++){targetBoard.board[i]=~targetBoard.board[i]>>>0}return targetBoard};BitBoard.prototype.shiftLeft=function(shiftAmount,modify){if(modify===void 0){modify=false}if(typeof shiftAmount==="number"){if(shiftAmount>=0){var targetBoard=modify?this:this.copy();var bitMask=Math.pow(2,shiftAmount)-1<<this.BITS_PER_BUCKET-shiftAmount>>>0;var carryDigits=(targetBoard.board[1]&bitMask)>>>0>>>this.BITS_PER_BUCKET-shiftAmount;if(shiftAmount===this.BITS_PER_BUCKET){targetBoard.board[1]=0;targetBoard.board[0]=carryDigits}else if(shiftAmount>this.BITS_PER_BUCKET&&shiftAmount<this.length){targetBoard.board[0]=targetBoard.board[1]<<shiftAmount-this.BITS_PER_BUCKET>>>0;targetBoard.board[1]=0}else if(shiftAmount>=this.length){targetBoard.board[0]=0;targetBoard.board[1]=0}else{targetBoard.board[1]=targetBoard.board[1]<<shiftAmount>>>0;targetBoard.board[0]=(targetBoard.board[0]<<shiftAmount>>>0|carryDigits)>>>0}return targetBoard}throw new RangeError("Invalid input. index must be >= 0")}throw new TypeError('Invalid input. Must be "number"')};BitBoard.prototype.shiftRight=function(shiftAmount,modify){if(modify===void 0){modify=false}if(typeof shiftAmount==="number"){if(shiftAmount>=0){var targetBoard=modify?this:this.copy();var bitMask=Math.pow(2,shiftAmount)-1<<this.BITS_PER_BUCKET-shiftAmount>>>0;var carryDigits=(targetBoard.board[0]<<this.BITS_PER_BUCKET-shiftAmount>>>0&bitMask)>>>0;if(shiftAmount===this.BITS_PER_BUCKET){targetBoard.board[0]=0;targetBoard.board[1]=carryDigits}else if(shiftAmount>this.BITS_PER_BUCKET&&shiftAmount<this.length){targetBoard.board[1]=targetBoard.board[0]>>>shiftAmount-this.BITS_PER_BUCKET>>>0;targetBoard.board[0]=0}else if(shiftAmount>=this.length){targetBoard.board[0]=0;targetBoard.board[1]=0}else{targetBoard.board[0]=targetBoard.board[0]>>>shiftAmount>>>0;targetBoard.board[1]=(targetBoard.board[1]>>>shiftAmount|carryDigits)>>>0}return targetBoard}throw new RangeError("Invalid input. index must be >= 0")}throw new TypeError('Invalid input. Must be "number"')};BitBoard.prototype.flipVertical=function(modify){if(modify===void 0){modify=false}var targetBoard=modify?this:this.copy();var mask1=new BitBoard([16711935,16711935]);var mask2=new BitBoard([65535,65535]);targetBoard=targetBoard.shiftRight(8).and(mask1).or(targetBoard.and(mask1).shiftLeft(8));targetBoard=targetBoard.shiftRight(16).and(mask2).or(targetBoard.and(mask2).shiftLeft(16));targetBoard=targetBoard.shiftRight(32).or(targetBoard.shiftLeft(32));return targetBoard};BitBoard.prototype.flipDiagonal=function(modify){if(modify===void 0){modify=false}var targetBoard=modify?this:this.copy();var mask1=new BitBoard([2852170240,2852170240]);var mask2=new BitBoard([3435921408,3435921408]);var mask4=new BitBoard([4042322160,252645135]);var temp=targetBoard.xOr(targetBoard.shiftLeft(36));targetBoard.xOr(mask4.and(temp.xOr(targetBoard.shiftRight(36))),true);temp=mask2.and(targetBoard.xOr(targetBoard.shiftLeft(18)));targetBoard.xOr(temp.xOr(temp.shiftRight(18)),true);temp=mask1.and(targetBoard.xOr(targetBoard.shiftLeft(9)));return targetBoard.xOr(temp.xOr(temp.shiftRight(9)),true)};BitBoard.prototype.rotate180Degrees=function(modify){if(modify===void 0){modify=false}var targetBoard=modify?this:this.copy();var maskh1=new BitBoard([1431655765,1431655765]);var maskh2=new BitBoard([858993459,858993459]);var maskh4=new BitBoard([252645135,252645135]);var maskv1=new BitBoard([16711935,16711935]);var maskv2=new BitBoard([65535,65535]);targetBoard=targetBoard.shiftRight(1).and(maskh1).or(targetBoard.and(maskh1).shiftLeft(1));targetBoard=targetBoard.shiftRight(2).and(maskh2).or(targetBoard.and(maskh2).shiftLeft(2));targetBoard=targetBoard.shiftRight(4).and(maskh4).or(targetBoard.and(maskh4).shiftLeft(4));targetBoard=targetBoard.shiftRight(8).and(maskv1).or(targetBoard.and(maskv1).shiftLeft(8));targetBoard=targetBoard.shiftRight(16).and(maskv2).or(targetBoard.and(maskv2).shiftLeft(16));targetBoard=targetBoard.shiftRight(32).or(targetBoard.shiftLeft(32));return targetBoard};BitBoard.prototype.rotate90DegreesClockwise=function(modify){if(modify===void 0){modify=false}var targetBoard=modify?this:this.copy();return targetBoard.flipDiagonal().flipVertical()};return BitBoard}();function padString(str,length,padValue,start){if(start){for(var i=str.length;i<length;i++){str=padValue+str}}else{for(var i=str.length;i<length;i++){str+=padValue}}return str}var ChessBitBoard=function(_super){__extends(ChessBitBoard,_super);function ChessBitBoard(input){var _this=this;if(input&&input.boardType){switch(input.boardType){case"piece":_this=_super.call(this,[4294901760,65535])||this;break;case"black":input.lsb==="a1"?_this=_super.call(this,[4294901760,0])||this:_this=_super.call(this,[0,65535])||this;break;case"white":input.lsb==="a1"?_this=_super.call(this,[0,65535])||this:_this=_super.call(this,[4294901760,0])||this;break;case"pawn":_this=_super.call(this,[16711680,65280])||this;break;case"knight":_this=_super.call(this,[1107296256,66])||this;break;case"bishop":_this=_super.call(this,[603979776,36])||this;break;case"rook":_this=_super.call(this,[2164260864,129])||this;break;case"queen":_this=_super.call(this,[268435456,16])||this;break;case"king":_this=_super.call(this,[134217728,8])||this;break;default:throw new SyntaxError('Input is not a valid value for boardType. Must be one of the following:\n\t"black", "white", "piece", "pawn", "knight", "bishop", "rook", "queen", "king"')}}else if(input&&input.board){_this=_super.call(this,input.board)||this}else{_this=_super.call(this,input)||this}return _this}return ChessBitBoard}(BitBoard);var ConnectFourBitBoard=function(_super){__extends(ConnectFourBitBoard,_super);function ConnectFourBitBoard(board){if(board===void 0){board=[0,0]}return _super.call(this,board)||this}ConnectFourBitBoard.isWin=function(bb){var directions=[1,7,6,8];for(var _i=0,directions_1=directions;_i<directions_1.length;_i++){var direction=directions_1[_i];var firstShift=bb.shiftRight(2*direction);var secondShift=bb.shiftRight(3*direction);var result=bb.and(bb.shiftRight(direction)).and(firstShift).and(secondShift);if(!result.isEmpty())return true}return false};return ConnectFourBitBoard}(BitBoard);if(typeof exports!=="undefined"){module.exports={BitBoard:BitBoard,ChessBitBoard:ChessBitBoard,ConnectFourBitBoard:ConnectFourBitBoard}}else if(typeof define!=="undefined"){define(function(){return{BitBoard:BitBoard,ChessBitBoard:ChessBitBoard,ConnectFourBitBoard:ConnectFourBitBoard}})}
